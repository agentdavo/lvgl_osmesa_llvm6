# For relocatable builds, use the function from parent CMakeLists.txt
if(COMMAND add_relocatable_executable)
    add_relocatable_executable(dx8_cube main.cpp)
else()
    add_executable(dx8_cube main.cpp)
endif()

target_link_libraries(dx8_cube
    PRIVATE
        lvgl
        lvgl_platform
        dx8gl
        OSMesa
        ${CMAKE_THREAD_LIBS_INIT}
)

target_include_directories(dx8_cube
    PRIVATE
        ${CMAKE_SOURCE_DIR}/src/lvgl_platform
        ${CMAKE_SOURCE_DIR}/ext/dx8gl/src
        ${CMAKE_SOURCE_DIR}/src/lvgl_platform
        ${CMAKE_SOURCE_DIR}/ext/glm
)

# For non-relocatable builds, set standard RPATH
if(NOT BUILD_RELOCATABLE)
    set_target_properties(dx8_cube PROPERTIES
        INSTALL_RPATH_USE_LINK_PATH TRUE
    )
endif()

# Install the executable
install(TARGETS dx8_cube
    RUNTIME DESTINATION bin
)

# Copy texture file to build directory
configure_file(${CMAKE_CURRENT_SOURCE_DIR}/wall01.tga
               ${CMAKE_CURRENT_BINARY_DIR}/wall01.tga
               COPYONLY)